(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const xn=!1;var br=Array.isArray,kr=Array.from,An=Object.defineProperty,Ye=Object.getOwnPropertyDescriptor,Ps=Object.getOwnPropertyDescriptors,jn=Object.prototype,In=Array.prototype,It=Object.getPrototypeOf;function Rn(r){return r()}function nr(r){for(var e=0;e<r.length;e++)r[e]()}const oe=2,xs=4,mt=8,Er=16,le=32,yt=64,ir=128,De=256,Rt=512,K=1024,Oe=2048,wt=4096,he=8192,rt=16384,Cn=32768,Sr=65536,Ln=1<<17,Dn=1<<19,As=1<<20,Le=Symbol("$state"),Un=Symbol("legacy props"),Nn=Symbol("");function js(r){return r===this.v}function Mn(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function Is(r){return!Mn(r,this.v)}function qn(r){throw new Error("effect_in_teardown")}function Fn(){throw new Error("effect_in_unowned_derived")}function Bn(r){throw new Error("effect_orphan")}function zn(){throw new Error("effect_update_depth_exceeded")}function Jn(r){throw new Error("props_invalid_value")}function Hn(){throw new Error("state_descriptors_fixed")}function Vn(){throw new Error("state_prototype_fixed")}function Gn(){throw new Error("state_unsafe_local_read")}function Kn(){throw new Error("state_unsafe_mutation")}let st=!1;function Wn(){st=!0}function z(r){return{f:0,v:r,reactions:null,equals:js,version:0}}function j(r){return Rs(z(r))}function Tr(r,e=!1){const t=z(r);return e||(t.equals=Is),st&&C!==null&&C.l!==null&&(C.l.s??=[]).push(t),t}function Qn(r,e=!1){return Rs(Tr(r,e))}function Rs(r){return I!==null&&I.f&oe&&(de===null?_i([r]):de.push(r)),r}function w(r,e){return I!==null&&Bt()&&I.f&(oe|Er)&&(de===null||!de.includes(r))&&Kn(),ar(r,e)}function ar(r,e){return r.equals(e)||(r.v=e,r.version=Qs(),Cs(r,Oe),Bt()&&A!==null&&A.f&K&&!(A.f&le)&&(J!==null&&J.includes(r)?(ve(A,Oe),Ht(A)):ke===null?pi([r]):ke.push(r))),e}function Cs(r,e){var t=r.reactions;if(t!==null)for(var s=Bt(),n=t.length,i=0;i<n;i++){var a=t[i],o=a.f;o&Oe||!s&&a===A||(ve(a,e),o&(K|De)&&(o&oe?Cs(a,wt):Ht(a)))}}const Or=1,$r=2,Ls=4,Yn=8,Xn=16,Zn=1,ei=2,ti=8,ri=1,si=2,W=Symbol();let Ds=!1;function P(r,e=null,t){if(typeof r!="object"||r===null||Le in r)return r;const s=It(r);if(s!==jn&&s!==In)return r;var n=new Map,i=br(r),a=z(0);i&&n.set("length",z(r.length));var o;return new Proxy(r,{defineProperty(l,c,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Hn();var h=n.get(c);return h===void 0?(h=z(u.value),n.set(c,h)):w(h,P(u.value,o)),!0},deleteProperty(l,c){var u=n.get(c);if(u===void 0)c in l&&n.set(c,z(W));else{if(i&&typeof c=="string"){var h=n.get("length"),d=Number(c);Number.isInteger(d)&&d<h.v&&w(h,d)}w(u,W),Br(a)}return!0},get(l,c,u){if(c===Le)return r;var h=n.get(c),d=c in l;if(h===void 0&&(!d||Ye(l,c)?.writable)&&(h=z(P(d?l[c]:W,o)),n.set(c,h)),h!==void 0){var f=v(h);return f===W?void 0:f}return Reflect.get(l,c,u)},getOwnPropertyDescriptor(l,c){var u=Reflect.getOwnPropertyDescriptor(l,c);if(u&&"value"in u){var h=n.get(c);h&&(u.value=v(h))}else if(u===void 0){var d=n.get(c),f=d?.v;if(d!==void 0&&f!==W)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return u},has(l,c){if(c===Le)return!0;var u=n.get(c),h=u!==void 0&&u.v!==W||Reflect.has(l,c);if(u!==void 0||A!==null&&(!h||Ye(l,c)?.writable)){u===void 0&&(u=z(h?P(l[c],o):W),n.set(c,u));var d=v(u);if(d===W)return!1}return h},set(l,c,u,h){var d=n.get(c),f=c in l;if(i&&c==="length")for(var _=u;_<d.v;_+=1){var p=n.get(_+"");p!==void 0?w(p,W):_ in l&&(p=z(W),n.set(_+"",p))}d===void 0?(!f||Ye(l,c)?.writable)&&(d=z(void 0),w(d,P(u,o)),n.set(c,d)):(f=d.v!==W,w(d,P(u,o)));var m=Reflect.getOwnPropertyDescriptor(l,c);if(m?.set&&m.set.call(h,u),!f){if(i&&typeof c=="string"){var b=n.get("length"),E=Number(c);Number.isInteger(E)&&E>=b.v&&w(b,E+1)}Br(a)}return!0},ownKeys(l){v(a);var c=Reflect.ownKeys(l).filter(d=>{var f=n.get(d);return f===void 0||f.v!==W});for(var[u,h]of n)h.v!==W&&!(u in l)&&c.push(u);return c},setPrototypeOf(){Vn()}})}function Br(r,e=1){w(r,r.v+e)}var zr,Us,Ns;function ni(){if(zr===void 0){zr=window;var r=Element.prototype,e=Node.prototype;Us=Ye(e,"firstChild").get,Ns=Ye(e,"nextSibling").get,r.__click=void 0,r.__className="",r.__attributes=null,r.__styles=null,r.__e=void 0,Text.prototype.__t=void 0}}function Pr(r=""){return document.createTextNode(r)}function Ct(r){return Us.call(r)}function Ft(r){return Ns.call(r)}function O(r,e){return Ct(r)}function xr(r,e){{var t=Ct(r);return t instanceof Comment&&t.data===""?Ft(t):t}}function k(r,e=1,t=!1){let s=r;for(;e--;)s=Ft(s);return s}function ii(r){r.textContent=""}function Lt(r){var e=oe|Oe;A===null?e|=De:A.f|=As;var t=I!==null&&I.f&oe?I:null;const s={children:null,ctx:C,deps:null,equals:js,f:e,fn:r,reactions:null,v:null,version:0,parent:t??A};return t!==null&&(t.children??=[]).push(s),s}function ai(r){const e=Lt(r);return e.equals=Is,e}function Ms(r){var e=r.children;if(e!==null){r.children=null;for(var t=0;t<e.length;t+=1){var s=e[t];s.f&oe?Ar(s):Ue(s)}}}function oi(r){for(var e=r.parent;e!==null;){if(!(e.f&oe))return e;e=e.parent}return null}function qs(r){var e,t=A;fe(oi(r));try{Ms(r),e=Ys(r)}finally{fe(t)}return e}function Fs(r){var e=qs(r),t=(Qe||r.f&De)&&r.deps!==null?wt:K;ve(r,t),r.equals(e)||(r.v=e,r.version=Qs())}function Ar(r){Ms(r),pt(r,0),ve(r,rt),r.v=r.children=r.deps=r.ctx=r.reactions=null}function Bs(r){A===null&&I===null&&Bn(),I!==null&&I.f&De&&Fn(),Dr&&qn()}function li(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function nt(r,e,t,s=!0){var n=(r&yt)!==0,i=A,a={ctx:C,deps:null,deriveds:null,nodes_start:null,nodes_end:null,f:r|Oe,first:null,fn:e,last:null,next:null,parent:n?null:i,prev:null,teardown:null,transitions:null,version:0};if(t){var o=Xe;try{Jr(!0),Jt(a),a.f|=Cn}catch(u){throw Ue(a),u}finally{Jr(o)}}else e!==null&&Ht(a);var l=t&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&As)===0;if(!l&&!n&&s&&(i!==null&&li(a,i),I!==null&&I.f&oe)){var c=I;(c.children??=[]).push(a)}return a}function ci(r){const e=nt(mt,null,!1);return ve(e,K),e.teardown=r,e}function F(r){Bs();var e=A!==null&&(A.f&le)!==0&&C!==null&&!C.m;if(e){var t=C;(t.e??=[]).push({fn:r,effect:A,reaction:I})}else{var s=jr(r);return s}}function ui(r){return Bs(),Ir(r)}function hi(r){const e=nt(yt,r,!0);return()=>{Ue(e)}}function jr(r){return nt(xs,r,!1)}function Ir(r){return nt(mt,r,!0)}function ae(r){return Rr(r)}function Rr(r,e=0){return nt(mt|Er|e,r,!0)}function _t(r,e=!0){return nt(mt|le,r,!0,e)}function zs(r){var e=r.teardown;if(e!==null){const t=Dr,s=I;Hr(!0),$e(null);try{e.call(null)}finally{Hr(t),$e(s)}}}function Js(r){var e=r.deriveds;if(e!==null){r.deriveds=null;for(var t=0;t<e.length;t+=1)Ar(e[t])}}function Hs(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){var s=t.next;Ue(t,e),t=s}}function di(r){for(var e=r.first;e!==null;){var t=e.next;e.f&le||Ue(e),e=t}}function Ue(r,e=!0){var t=!1;if((e||r.f&Dn)&&r.nodes_start!==null){for(var s=r.nodes_start,n=r.nodes_end;s!==null;){var i=s===n?null:Ft(s);s.remove(),s=i}t=!0}Hs(r,e&&!t),Js(r),pt(r,0),ve(r,rt);var a=r.transitions;if(a!==null)for(const l of a)l.stop();zs(r);var o=r.parent;o!==null&&o.first!==null&&Vs(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=null}function Vs(r){var e=r.parent,t=r.prev,s=r.next;t!==null&&(t.next=s),s!==null&&(s.prev=t),e!==null&&(e.first===r&&(e.first=s),e.last===r&&(e.last=t))}function or(r,e){var t=[];Cr(r,t,!0),Gs(t,()=>{Ue(r),e&&e()})}function Gs(r,e){var t=r.length;if(t>0){var s=()=>--t||e();for(var n of r)n.out(s)}else e()}function Cr(r,e,t){if(!(r.f&he)){if(r.f^=he,r.transitions!==null)for(const a of r.transitions)(a.is_global||t)&&e.push(a);for(var s=r.first;s!==null;){var n=s.next,i=(s.f&Sr)!==0||(s.f&le)!==0;Cr(s,e,i?t:!1),s=n}}}function Dt(r){Ks(r,!0)}function Ks(r,e){if(r.f&he){bt(r)&&Jt(r),r.f^=he;for(var t=r.first;t!==null;){var s=t.next,n=(t.f&Sr)!==0||(t.f&le)!==0;Ks(t,n?e:!1),t=s}if(r.transitions!==null)for(const i of r.transitions)(i.is_global||e)&&i.in()}}let lr=!1,cr=[];function fi(){lr=!1;const r=cr.slice();cr=[],nr(r)}function Lr(r){lr||(lr=!0,queueMicrotask(fi)),cr.push(r)}function vi(r){throw new Error("lifecycle_outside_component")}let jt=!1,Ut=!1,Nt=null,Xe=!1,Dr=!1;function Jr(r){Xe=r}function Hr(r){Dr=r}let ur=[],dt=0;let I=null;function $e(r){I=r}let A=null;function fe(r){A=r}let de=null;function _i(r){de=r}let J=null,Q=0,ke=null;function pi(r){ke=r}let Ws=0,Qe=!1,C=null;function Qs(){return++Ws}function Bt(){return!st||C!==null&&C.l===null}function bt(r){var e=r.f;if(e&Oe)return!0;if(e&wt){var t=r.deps,s=(e&De)!==0;if(t!==null){var n;if(e&Rt){for(n=0;n<t.length;n++)(t[n].reactions??=[]).push(r);r.f^=Rt}for(n=0;n<t.length;n++){var i=t[n];if(bt(i)&&Fs(i),s&&A!==null&&!Qe&&!i?.reactions?.includes(r)&&(i.reactions??=[]).push(r),i.version>r.version)return!0}}s||ve(r,K)}return!1}function gi(r,e){for(var t=e;t!==null;){if(t.f&ir)try{t.fn(r);return}catch{t.f^=ir}t=t.parent}throw jt=!1,r}function mi(r){return(r.f&rt)===0&&(r.parent===null||(r.parent.f&ir)===0)}function zt(r,e,t,s){if(jt){if(t===null&&(jt=!1),mi(e))throw r;return}t!==null&&(jt=!0);{gi(r,e);return}}function Ys(r){var e=J,t=Q,s=ke,n=I,i=Qe,a=de,o=C,l=r.f;J=null,Q=0,ke=null,I=l&(le|yt)?null:r,Qe=!Xe&&(l&De)!==0,de=null,C=r.ctx;try{var c=(0,r.fn)(),u=r.deps;if(J!==null){var h;if(pt(r,Q),u!==null&&Q>0)for(u.length=Q+J.length,h=0;h<J.length;h++)u[Q+h]=J[h];else r.deps=u=J;if(!Qe)for(h=Q;h<u.length;h++)(u[h].reactions??=[]).push(r)}else u!==null&&Q<u.length&&(pt(r,Q),u.length=Q);return c}finally{J=e,Q=t,ke=s,I=n,Qe=i,de=a,C=o}}function yi(r,e){let t=e.reactions;if(t!==null){var s=t.indexOf(r);if(s!==-1){var n=t.length-1;n===0?t=e.reactions=null:(t[s]=t[n],t.pop())}}t===null&&e.f&oe&&(J===null||!J.includes(e))&&(ve(e,wt),e.f&(De|Rt)||(e.f^=Rt),pt(e,0))}function pt(r,e){var t=r.deps;if(t!==null)for(var s=e;s<t.length;s++)yi(r,t[s])}function Jt(r){var e=r.f;if(!(e&rt)){ve(r,K);var t=A,s=C;A=r;try{e&Er?di(r):Hs(r),Js(r),zs(r);var n=Ys(r);r.teardown=typeof n=="function"?n:null,r.version=Ws}catch(i){zt(i,r,t,s||r.ctx)}finally{A=t}}}function wi(){if(dt>1e3){dt=0;try{zn()}catch(r){if(Nt!==null)zt(r,Nt,null);else throw r}}dt++}function bi(r){var e=r.length;if(e!==0){wi();var t=Xe;Xe=!0;try{for(var s=0;s<e;s++){var n=r[s];n.f&K||(n.f^=K);var i=[];Xs(n,i),ki(i)}}finally{Xe=t}}}function ki(r){var e=r.length;if(e!==0)for(var t=0;t<e;t++){var s=r[t];if(!(s.f&(rt|he)))try{bt(s)&&(Jt(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null?Vs(s):s.fn=null))}catch(n){zt(n,s,null,s.ctx)}}}function Ei(){if(Ut=!1,dt>1001)return;const r=ur;ur=[],bi(r),Ut||(dt=0,Nt=null)}function Ht(r){Ut||(Ut=!0,queueMicrotask(Ei)),Nt=r;for(var e=r;e.parent!==null;){e=e.parent;var t=e.f;if(t&(yt|le)){if(!(t&K))return;e.f^=K}}ur.push(e)}function Xs(r,e){var t=r.first,s=[];e:for(;t!==null;){var n=t.f,i=(n&le)!==0,a=i&&(n&K)!==0,o=t.next;if(!a&&!(n&he))if(n&mt){if(i)t.f^=K;else try{bt(t)&&Jt(t)}catch(h){zt(h,t,null,t.ctx)}var l=t.first;if(l!==null){t=l;continue}}else n&xs&&s.push(t);if(o===null){let h=t.parent;for(;h!==null;){if(r===h)break e;var c=h.next;if(c!==null){t=c;continue e}h=h.parent}}t=o}for(var u=0;u<s.length;u++)l=s[u],e.push(l),Xs(l,e)}function v(r){var e=r.f,t=(e&oe)!==0;if(t&&e&rt){var s=qs(r);return Ar(r),s}if(I!==null){de!==null&&de.includes(r)&&Gn();var n=I.deps;J===null&&n!==null&&n[Q]===r?Q++:J===null?J=[r]:J.push(r),ke!==null&&A!==null&&A.f&K&&!(A.f&le)&&ke.includes(r)&&(ve(A,Oe),Ht(A))}else if(t&&r.deps===null)for(var i=r,a=i.parent,o=i;a!==null;)if(a.f&oe){var l=a;o=l,a=l.parent}else{var c=a;c.deriveds?.includes(o)||(c.deriveds??=[]).push(o);break}return t&&(i=r,bt(i)&&Fs(i)),r.v}function kt(r){const e=I;try{return I=null,r()}finally{I=e}}const Si=~(Oe|wt|K);function ve(r,e){r.f=r.f&Si|e}function Z(r,e=!1,t){C={p:C,c:null,e:null,m:!1,s:r,x:null,l:null},st&&!e&&(C.l={s:null,u:null,r1:[],r2:z(!1)})}function ee(r){const e=C;if(e!==null){const a=e.e;if(a!==null){var t=A,s=I;e.e=null;try{for(var n=0;n<a.length;n++){var i=a[n];fe(i.effect),$e(i.reaction),jr(i.fn)}}finally{fe(t),$e(s)}}C=e.p,e.m=!0}return{}}function Ti(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(Le in r)hr(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&Le in t&&hr(t)}}}function hr(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let s in r)try{hr(r[s],e)}catch{}const t=It(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const s=Ps(t);for(let n in s){const i=s[n].get;if(i)try{i.call(r)}catch{}}}}}let Vr=!1;function Oi(){Vr||(Vr=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{if(!r.defaultPrevented)for(const e of r.target.elements)e.__on_r?.()})},{capture:!0}))}function Zs(r){var e=I,t=A;$e(null),fe(null);try{return r()}finally{$e(e),fe(t)}}function $i(r,e,t,s=t){r.addEventListener(e,()=>Zs(t));const n=r.__on_r;n?r.__on_r=()=>{n(),s(!0)}:r.__on_r=()=>s(!0),Oi()}const en=new Set,dr=new Set;function Pi(r,e,t,s){function n(i){if(s.capture||ut.call(e,i),!i.cancelBubble)return Zs(()=>t.call(this,i))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?Lr(()=>{e.addEventListener(r,n,s)}):e.addEventListener(r,n,s),n}function Pe(r,e,t,s,n){var i={capture:s,passive:n},a=Pi(r,e,t,i);(e===document.body||e===window||e===document)&&ci(()=>{e.removeEventListener(r,a,i)})}function _e(r){for(var e=0;e<r.length;e++)en.add(r[e]);for(var t of dr)t(r)}function ut(r){var e=this,t=e.ownerDocument,s=r.type,n=r.composedPath?.()||[],i=n[0]||r.target,a=0,o=r.__root;if(o){var l=n.indexOf(o);if(l!==-1&&(e===document||e===window)){r.__root=e;return}var c=n.indexOf(e);if(c===-1)return;l<=c&&(a=l)}if(i=n[a]||r.target,i!==e){An(r,"currentTarget",{configurable:!0,get(){return i||t}});var u=I,h=A;$e(null),fe(null);try{for(var d,f=[];i!==null;){var _=i.assignedSlot||i.parentNode||i.host||null;try{var p=i["__"+s];if(p!==void 0&&!i.disabled)if(br(p)){var[m,...b]=p;m.apply(i,[r,...b])}else p.call(i,r)}catch(E){d?f.push(E):d=E}if(r.cancelBubble||_===e||_===null)break;i=_}if(d){for(let E of f)queueMicrotask(()=>{throw E});throw d}}finally{r.__root=e,delete r.currentTarget,$e(u),fe(h)}}}function xi(r){var e=document.createElement("template");return e.innerHTML=r,e.content}function fr(r,e){var t=A;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function N(r,e){var t=(e&ri)!==0,s=(e&si)!==0,n,i=!r.startsWith("<!>");return()=>{n===void 0&&(n=xi(i?r:"<!>"+r),t||(n=Ct(n)));var a=s?document.importNode(n,!0):n.cloneNode(!0);if(t){var o=Ct(a),l=a.lastChild;fr(o,l)}else fr(a,a);return a}}function Ai(r=""){{var e=Pr(r+"");return fr(e,e),e}}function L(r,e){r!==null&&r.before(e)}const ji=["touchstart","touchmove"];function Ii(r){return ji.includes(r)}function ce(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??=r.nodeValue)&&(r.__t=t,r.nodeValue=t==null?"":t+"")}function Ri(r,e){return Ci(r,e)}const Fe=new Map;function Ci(r,{target:e,anchor:t,props:s={},events:n,context:i,intro:a=!0}){ni();var o=new Set,l=h=>{for(var d=0;d<h.length;d++){var f=h[d];if(!o.has(f)){o.add(f);var _=Ii(f);e.addEventListener(f,ut,{passive:_});var p=Fe.get(f);p===void 0?(document.addEventListener(f,ut,{passive:_}),Fe.set(f,1)):Fe.set(f,p+1)}}};l(kr(en)),dr.add(l);var c=void 0,u=hi(()=>{var h=t??e.appendChild(Pr());return _t(()=>{if(i){Z({});var d=C;d.c=i}n&&(s.$$events=n),c=r(h,s)||{},i&&ee()}),()=>{for(var d of o){e.removeEventListener(d,ut);var f=Fe.get(d);--f===0?(document.removeEventListener(d,ut),Fe.delete(d)):Fe.set(d,f)}dr.delete(l),Gr.delete(c),h!==t&&h.parentNode?.removeChild(h)}});return Gr.set(c,u),c}let Gr=new WeakMap;function tn(r,e,t=!1){var s=r,n=null,i=null,a=null,o=t?Sr:0,l=!1;const c=(h,d=!0)=>{l=!0,u(d,h)},u=(h,d)=>{a!==(a=h)&&(a?(n?Dt(n):d&&(n=_t(()=>d(s))),i&&or(i,()=>{i=null})):(i?Dt(i):d&&(i=_t(()=>d(s))),n&&or(n,()=>{n=null})))};Rr(()=>{l=!1,e(c),l||u(null,null)},o)}function Ee(r,e){return e}function Li(r,e,t,s){for(var n=[],i=e.length,a=0;a<i;a++)Cr(e[a].e,n,!0);var o=i>0&&n.length===0&&t!==null;if(o){var l=t.parentNode;ii(l),l.append(t),s.clear(),me(r,e[0].prev,e[i-1].next)}Gs(n,()=>{for(var c=0;c<i;c++){var u=e[c];o||(s.delete(u.k),me(r,u.prev,u.next)),Ue(u.e,!o)}})}function Se(r,e,t,s,n,i=null){var a=r,o={flags:e,items:new Map,first:null},l=(e&Ls)!==0;if(l){var c=r;a=c.appendChild(Pr())}var u=null,h=!1;Rr(()=>{var d=t(),f=br(d)?d:d==null?[]:kr(d),_=f.length;if(!(h&&_===0)){h=_===0;{var p=I;Di(f,o,a,n,e,(p.f&he)!==0,s)}i!==null&&(_===0?u?Dt(u):u=_t(()=>i(a)):u!==null&&or(u,()=>{u=null})),t()}})}function Di(r,e,t,s,n,i,a){var o=(n&Yn)!==0,l=(n&(Or|$r))!==0,c=r.length,u=e.items,h=e.first,d=h,f,_=null,p,m=[],b=[],E,T,g,y;if(o)for(y=0;y<c;y+=1)E=r[y],T=a(E,y),g=u.get(T),g!==void 0&&(g.a?.measure(),(p??=new Set).add(g));for(y=0;y<c;y+=1){if(E=r[y],T=a(E,y),g=u.get(T),g===void 0){var S=d?d.e.nodes_start:t;_=Ni(S,e,_,_===null?e.first:_.next,E,T,y,s,n),u.set(T,_),m=[],b=[],d=_.next;continue}if(l&&Ui(g,E,y,n),g.e.f&he&&(Dt(g.e),o&&(g.a?.unfix(),(p??=new Set).delete(g))),g!==d){if(f!==void 0&&f.has(g)){if(m.length<b.length){var D=b[0],B;_=D.prev;var qe=m[0],xe=m[m.length-1];for(B=0;B<m.length;B+=1)Kr(m[B],D,t);for(B=0;B<b.length;B+=1)f.delete(b[B]);me(e,qe.prev,xe.next),me(e,_,qe),me(e,xe,D),d=D,_=xe,y-=1,m=[],b=[]}else f.delete(g),Kr(g,d,t),me(e,g.prev,g.next),me(e,g,_===null?e.first:_.next),me(e,_,g),_=g;continue}for(m=[],b=[];d!==null&&d.k!==T;)(i||!(d.e.f&he))&&(f??=new Set).add(d),b.push(d),d=d.next;if(d===null)continue;g=d}m.push(g),_=g,d=g.next}if(d!==null||f!==void 0){for(var Ae=f===void 0?[]:kr(f);d!==null;)(i||!(d.e.f&he))&&Ae.push(d),d=d.next;var je=Ae.length;if(je>0){var Pn=n&Ls&&c===0?t:null;if(o){for(y=0;y<je;y+=1)Ae[y].a?.measure();for(y=0;y<je;y+=1)Ae[y].a?.fix()}Li(e,Ae,Pn,u)}}o&&Lr(()=>{if(p!==void 0)for(g of p)g.a?.apply()}),A.first=e.first&&e.first.e,A.last=_&&_.e}function Ui(r,e,t,s){s&Or&&ar(r.v,e),s&$r?ar(r.i,t):r.i=t}function Ni(r,e,t,s,n,i,a,o,l){var c=(l&Or)!==0,u=(l&Xn)===0,h=c?u?Tr(n):z(n):n,d=l&$r?z(a):a,f={i:d,v:h,k:i,a:null,e:null,prev:t,next:s};try{return f.e=_t(()=>o(r,h,d),Ds),f.e.prev=t&&t.e,f.e.next=s&&s.e,t===null?e.first=f:(t.next=f,t.e.next=f.e),s!==null&&(s.prev=f,s.e.prev=f.e),f}finally{}}function Kr(r,e,t){for(var s=r.next?r.next.e.nodes_start:t,n=e?e.e.nodes_start:t,i=r.e.nodes_start;i!==s;){var a=Ft(i);n.before(i),i=a}}function me(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function Mt(r,e,t,s){var n=r.__attributes??={};n[e]!==(n[e]=t)&&(e==="style"&&"__styles"in r&&(r.__styles={}),e==="loading"&&(r[Nn]=t),t==null?r.removeAttribute(e):typeof t!="string"&&Mi(r).includes(e)?r[e]=t:r.setAttribute(e,t))}var Wr=new Map;function Mi(r){var e=Wr.get(r.nodeName);if(e)return e;Wr.set(r.nodeName,e=[]);for(var t,s=It(r),n=Element.prototype;n!==s;){t=Ps(s);for(var i in t)t[i].set&&e.push(i);s=It(s)}return e}function rn(r,e){var t=r.__className,s=qi(e);(t!==s||Ds)&&(e==null?r.removeAttribute("class"):r.className=s,r.__className=s)}function qi(r){return r??""}function te(r,e,t=e){var s=Bt();$i(r,"input",n=>{var i=n?r.defaultValue:r.value;i=Wt(r)?Qt(i):i,t(i),s&&i!==(i=e())&&(r.value=i??"")}),kt(e)==null&&r.value&&t(Wt(r)?Qt(r.value):r.value),Ir(()=>{var n=e();Wt(r)&&n===Qt(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function Wt(r){var e=r.type;return e==="number"||e==="range"}function Qt(r){return r===""?null:+r}function Qr(r,e){return r===e||r?.[Le]===e}function Et(r={},e,t,s){return jr(()=>{var n,i;return Ir(()=>{n=i,i=[],kt(()=>{r!==t(...i)&&(e(r,...i),n&&Qr(t(...n),r)&&e(null,...n))})}),()=>{Lr(()=>{i&&Qr(t(...i),r)&&e(null,...i)})}}),r}function Fi(r=!1){const e=C,t=e.l.u;if(!t)return;let s=()=>Ti(e.s);if(r){let n=0,i={};const a=Lt(()=>{let o=!1;const l=e.s;for(const c in l)l[c]!==i[c]&&(i[c]=l[c],o=!0);return o&&n++,n});s=()=>v(a)}t.b.length&&ui(()=>{Yr(e,s),nr(t.b)}),F(()=>{const n=kt(()=>t.m.map(Rn));return()=>{for(const i of n)typeof i=="function"&&i()}}),t.a.length&&F(()=>{Yr(e,s),nr(t.a)})}function Yr(r,e){if(r.l.s)for(const t of r.l.s)v(t);e()}let Tt=!1;function Bi(r){var e=Tt;try{return Tt=!1,[r(),Tt]}finally{Tt=e}}function Xr(r){for(var e=A,t=A;e!==null&&!(e.f&(le|yt));)e=e.parent;try{return fe(e),r()}finally{fe(t)}}function Yt(r,e,t,s){var n=(t&Zn)!==0,i=!st||(t&ei)!==0,a=(t&ti)!==0,o=!1,l;[l,o]=Bi(()=>r[e]);var c=Le in r||Un in r,u=Ye(r,e)?.set??(c&&a&&e in r?S=>r[e]=S:void 0),h=s,d=!0,f=!1,_=()=>(f=!0,d&&(d=!1,h=s),h);l===void 0&&s!==void 0&&(u&&i&&Jn(),l=_(),u&&u(l));var p;if(i)p=()=>{var S=r[e];return S===void 0?_():(d=!0,f=!1,S)};else{var m=Xr(()=>(n?Lt:ai)(()=>r[e]));m.f|=Ln,p=()=>{var S=v(m);return S!==void 0&&(h=void 0),S===void 0?h:S}}if(u){var b=r.$$legacy;return function(S,D){return arguments.length>0?((!i||!D||b||o)&&u(D?p():S),S):p()}}var E=!1,T=!1,g=Tr(l),y=Xr(()=>Lt(()=>{var S=p(),D=v(g);return E?(E=!1,T=!0,D):(T=!1,g.v=S)}));return function(S,D){if(arguments.length>0){const B=D?v(y):i&&a?P(S):S;return y.equals(B)||(E=!0,w(g,B),f&&h!==void 0&&(h=B),kt(()=>v(y))),S}return v(y)}}function zi(r){C===null&&vi(),st&&C.l!==null?Ji(C).m.push(r):F(()=>{const e=kt(r);if(typeof e=="function")return e})}function Ji(r){var e=r.l;return e.u??={a:[],b:[],m:[]}}const Hi="5";typeof window<"u"&&(window.__svelte||={v:new Set}).v.add(Hi);Wn();function Xt(r){w(r,r.v+1)}var Vi=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],Gi=["difference","intersection","symmetricDifference","union"],Zr=!1;class Te extends Set{#e=new Map;#t=z(0);#r=z(0);constructor(e){if(super(),e){for(var t of e)super.add(t);this.#r.v=super.size}Zr||this.#s()}#s(){Zr=!0;var e=Te.prototype,t=Set.prototype;for(const s of Vi)e[s]=function(...n){return v(this.#t),t[s].apply(this,n)};for(const s of Gi)e[s]=function(...n){v(this.#t);var i=t[s].apply(this,n);return new Te(i)}}has(e){var t=super.has(e),s=this.#e,n=s.get(e);if(n===void 0){if(!t)return v(this.#t),!1;n=z(!0),s.set(e,n)}return v(n),t}add(e){return super.has(e)||(super.add(e),w(this.#r,super.size),Xt(this.#t)),this}delete(e){var t=super.delete(e),s=this.#e,n=s.get(e);return n!==void 0&&(s.delete(e),w(n,!1)),t&&(w(this.#r,super.size),Xt(this.#t)),t}clear(){if(super.size!==0){super.clear();var e=this.#e;for(var t of e.values())w(t,!1);e.clear(),w(this.#r,0),Xt(this.#t)}}keys(){return this.values()}values(){return v(this.#t),super.values()}entries(){return v(this.#t),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return v(this.#r)}}const Ki="modulepreload",Wi=function(r){return"/Scheduler/"+r},es={},et=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");n=Promise.allSettled(t.map(l=>{if(l=Wi(l),l in es)return;es[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":Ki,c||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},Qi=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>et(async()=>{const{default:s}=await Promise.resolve().then(()=>it);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Ur extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class Yi extends Ur{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Xi extends Ur{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Zi extends Ur{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var vr;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(vr||(vr={}));var ea=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class ta{constructor(e,{headers:t={},customFetch:s,region:n=vr.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=Qi(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return ea(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:c}).catch(_=>{throw new Yi(_)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new Xi(u);if(!u.ok)throw new Zi(u);let d=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield u.json():d==="application/octet-stream"?f=yield u.blob():d==="text/event-stream"?f=u:d==="multipart/form-data"?f=yield u.formData():f=yield u.text(),{data:f,error:null}}catch(n){return{data:null,error:n}}})}}function ra(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function sa(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var n=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:function(){return r[s]}})}),t}var M={},Be={},ze={},Je={},He={},Ve={},na=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},tt=na();const ia=tt.fetch,sn=tt.fetch.bind(tt),nn=tt.Headers,aa=tt.Request,oa=tt.Response,it=Object.freeze(Object.defineProperty({__proto__:null,Headers:nn,Request:aa,Response:oa,default:sn,fetch:ia},Symbol.toStringTag,{value:"Module"})),la=sa(it);var Ot={},ts;function an(){if(ts)return Ot;ts=1,Object.defineProperty(Ot,"__esModule",{value:!0});let r=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};return Ot.default=r,Ot}var rs;function on(){if(rs)return Ve;rs=1;var r=Ve&&Ve.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ve,"__esModule",{value:!0});const e=r(la),t=r(an());class s{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,a){return this.headers=Object.assign({},this.headers),this.headers[i]=a,this}then(i,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d;let f=null,_=null,p=null,m=c.status,b=c.statusText;if(c.ok){if(this.method!=="HEAD"){const y=await c.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?_=y:_=JSON.parse(y))}const T=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),g=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");T&&g&&g.length>1&&(p=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(f={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,p=null,m=406,b="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const T=await c.text();try{f=JSON.parse(T),Array.isArray(f)&&c.status===404&&(_=[],f=null,m=200,b="OK")}catch{c.status===404&&T===""?(m=204,b="No Content"):f={message:T}}if(f&&this.isMaybeSingle&&(!((d=f?.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,m=200,b="OK"),f&&this.shouldThrowOnError)throw new t.default(f)}return{error:f,data:_,count:p,status:m,statusText:b}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,a)}}return Ve.default=s,Ve}var ss;function ln(){if(ss)return He;ss=1;var r=He&&He.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(He,"__esModule",{value:!0});const e=r(on());class t extends e.default{select(n){let i=!1;const a=(n??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:i=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${n}.${i?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:a=i}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${n}`),this}range(n,i,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(c,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:i=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var u;const h=[n?"analyze":null,i?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${d}"; options=${h};`,c==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return He.default=t,He}var ns;function Nr(){if(ns)return Je;ns=1;var r=Je&&Je.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Je,"__esModule",{value:!0});const e=r(ln());class t extends e.default{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}in(n,i){const a=Array.from(new Set(i)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(n,`in.(${a})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:a,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const c=a===void 0?"":`(${a})`;return this.url.searchParams.append(n,`${l}fts${c}.${i}`),this}match(n){return Object.entries(n).forEach(([i,a])=>{this.url.searchParams.append(i,`eq.${a}`)}),this}not(n,i,a){return this.url.searchParams.append(n,`not.${i}.${a}`),this}or(n,{foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.or`:"or";return this.url.searchParams.append(o,`(${n})`),this}filter(n,i,a){return this.url.searchParams.append(n,`${i}.${a}`),this}}return Je.default=t,Je}var is;function cn(){if(is)return ze;is=1;var r=ze&&ze.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ze,"__esModule",{value:!0});const e=r(Nr());class t{constructor(n,{headers:i={},schema:a,fetch:o}){this.url=n,this.headers=i,this.schema=a,this.fetch=o}select(n,{head:i=!1,count:a}={}){const o=i?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),a&&(this.headers.Prefer=`count=${a}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:i,defaultToNull:a=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const c=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:i,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${a?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),o&&u.push(`count=${o}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const h=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:i}={}){const a="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),this.headers.Prefer=o.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const i="DELETE",a=[];return n&&a.push(`count=${n}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return ze.default=t,ze}var at={},ot={},as;function ca(){return as||(as=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.version=void 0,ot.version="0.0.0-automated"),ot}var os;function ua(){if(os)return at;os=1,Object.defineProperty(at,"__esModule",{value:!0}),at.DEFAULT_HEADERS=void 0;const r=ca();return at.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`},at}var ls;function ha(){if(ls)return Be;ls=1;var r=Be&&Be.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Be,"__esModule",{value:!0});const e=r(cn()),t=r(Nr()),s=ua();class n{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new n(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:u}={}){let h;const d=new URL(`${this.url}/rpc/${a}`);let f;l||c?(h=l?"HEAD":"GET",Object.entries(o).filter(([p,m])=>m!==void 0).map(([p,m])=>[p,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([p,m])=>{d.searchParams.append(p,m)})):(h="POST",f=o);const _=Object.assign({},this.headers);return u&&(_.Prefer=`count=${u}`),new t.default({method:h,url:d,headers:_,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return Be.default=n,Be}var cs;function da(){if(cs)return M;cs=1;var r=M&&M.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(M,"__esModule",{value:!0}),M.PostgrestError=M.PostgrestBuilder=M.PostgrestTransformBuilder=M.PostgrestFilterBuilder=M.PostgrestQueryBuilder=M.PostgrestClient=void 0;const e=r(ha());M.PostgrestClient=e.default;const t=r(cn());M.PostgrestQueryBuilder=t.default;const s=r(Nr());M.PostgrestFilterBuilder=s.default;const n=r(ln());M.PostgrestTransformBuilder=n.default;const i=r(on());M.PostgrestBuilder=i.default;const a=r(an());return M.PostgrestError=a.default,M.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:a.default},M}var fa=da();const va=ra(fa),{PostgrestClient:_a,PostgrestQueryBuilder:_c,PostgrestFilterBuilder:pc,PostgrestTransformBuilder:gc,PostgrestBuilder:mc}=va,pa="2.10.9",ga={"X-Client-Info":`realtime-js/${pa}`},ma="1.0.0",un=1e4,ya=1e3;var Ze;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(Ze||(Ze={}));var Y;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(Y||(Y={}));var se;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(se||(se={}));var _r;(function(r){r.websocket="websocket"})(_r||(_r={}));var Ce;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Ce||(Ce={}));class wa{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+n));a=a+n;const l=s.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class hn{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var R;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(R||(R={}));const us=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,a)=>(i[a]=ba(a,r,e,n),i),{})},ba=(r,e,t,s)=>{const n=e.find(o=>o.name===r),i=n?.type,a=t[r];return i&&!s.includes(i)?dn(i,a):pr(a)},dn=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Ta(e,t)}switch(r){case R.bool:return ka(e);case R.float4:case R.float8:case R.int2:case R.int4:case R.int8:case R.numeric:case R.oid:return Ea(e);case R.json:case R.jsonb:return Sa(e);case R.timestamp:return Oa(e);case R.abstime:case R.date:case R.daterange:case R.int4range:case R.int8range:case R.money:case R.reltime:case R.text:case R.time:case R.timestamptz:case R.timetz:case R.tsrange:case R.tstzrange:return pr(e);default:return pr(e)}},pr=r=>r,ka=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Ea=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},Sa=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Ta=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let i;const a=r.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>dn(e,o))}return r},Oa=r=>typeof r=="string"?r.replace(" ","T"):r,fn=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Zt{constructor(e,t,s={},n=un){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var hs;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(hs||(hs={}));class ft{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ft.syncState(this.state,n,i,a),this.pendingDiffs.forEach(l=>{this.state=ft.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ft.syncDiff(this.state,n,i,a),o())}),this.onJoin((n,i,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:a})}),this.onLeave((n,i,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const h=i[c];if(h){const d=u.map(m=>m.presence_ref),f=h.map(m=>m.presence_ref),_=u.filter(m=>f.indexOf(m.presence_ref)<0),p=h.filter(m=>d.indexOf(m.presence_ref)<0);_.length>0&&(o[c]=_),p.length>0&&(l[c]=p)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const h=e[o].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[o].unshift(...d)}s(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[o]=c,n(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ds;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(ds||(ds={}));var fs;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(fs||(fs={}));var vs;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(vs||(vs={}));class Mr{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=Y.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Zt(this,se.join,this.params,this.timeout),this.rejoinTimer=new hn(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Y.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Y.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Y.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Y.errored,this.rejoinTimer.scheduleTimeout())}),this._on(se.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new ft(this),this.broadcastEndpointURL=fn(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const l={},c={broadcast:i,presence:a,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:u})=>{var h;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const d=this.bindings.postgres_changes,f=(h=d?.length)!==null&&h!==void 0?h:0,_=[];for(let p=0;p<f;p++){const m=d[p],{filter:{event:b,schema:E,table:T,filter:g}}=m,y=u&&u[p];if(y&&y.event===b&&y.schema===E&&y.table===T&&y.filter===g)_.push(Object.assign(Object.assign({},m),{id:y.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=_,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,o={method:"POST",headers:{Authorization:this.socket.accessToken?`Bearer ${this.socket.accessToken}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=l.body)===null||n===void 0?void 0:n.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Y.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(se.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const n=new Zt(this,se.leave,{},e);n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(e,t,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Zt(this,e,t,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=se;if(s&&[o,l,c,u].indexOf(a)>=0&&s!==this._joinRef())return;let d=this._onMessage(a,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var _,p,m;return((_=f.filter)===null||_===void 0?void 0:_.event)==="*"||((m=(p=f.filter)===null||p===void 0?void 0:p.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===a}).map(f=>f.callback(d,s)):(i=this.bindings[a])===null||i===void 0||i.filter(f=>{var _,p,m,b,E,T;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const g=f.id,y=(_=f.filter)===null||_===void 0?void 0:_.event;return g&&((p=t.ids)===null||p===void 0?void 0:p.includes(g))&&(y==="*"||y?.toLocaleLowerCase()===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const g=(E=(b=f?.filter)===null||b===void 0?void 0:b.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return g==="*"||g===((T=t?.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof d=="object"&&"ids"in d){const _=d.data,{schema:p,table:m,commit_timestamp:b,type:E,errors:T}=_;d=Object.assign(Object.assign({},{schema:p,table:m,commit_timestamp:b,eventType:E,new:{},old:{},errors:T}),this._getPayloadRecords(_))}f.callback(d,s)})}_isClosed(){return this.state===Y.closed}_isJoined(){return this.state===Y.joined}_isJoining(){return this.state===Y.joining}_isLeaving(){return this.state===Y.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Mr.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(se.close,{},e)}_onError(e){this._on(se.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Y.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=us(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=us(e.columns,e.old_record)),t}}const $a=()=>{},Pa=typeof WebSocket<"u",xa=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Aa{constructor(e,t){var s;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=ga,this.params={},this.timeout=un,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=$a,this.conn=null,this.sendBuffer=[],this.serializer=new wa,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>et(async()=>{const{default:l}=await Promise.resolve().then(()=>it);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${_r.websocket}`,this.httpEndpoint=fn(e),t?.transport?this.transport=t.transport:this.transport=null,t?.params&&(this.params=t.params),t?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t?.timeout&&(this.timeout=t.timeout),t?.logger&&(this.logger=t.logger),t?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(s=t?.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessToken=n,this.apiKey=n),this.reconnectAfterMs=t?.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t?.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t?.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new hn(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t?.fetch),t?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=t?.worker||!1,this.workerUrl=t?.workerUrl}}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Pa){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new ja(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),et(async()=>{const{default:e}=await import("./browser-CGZJUKuE.js").then(t=>t.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ze.connecting:return Ce.Connecting;case Ze.open:return Ce.Open;case Ze.closing:return Ce.Closing;default:return Ce.Closed}}isConnected(){return this.connectionState()===Ce.Open}channel(e,t={config:{}}){const s=new Mr(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:n,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}setAuth(e){if(e){let t=null;try{t=JSON.parse(atob(e.split(".")[1]))}catch{}if(t&&t.exp&&!(Math.floor(Date.now()/1e3)-t.exp<0)){this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${t.exp}`);return}}this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(se.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ma}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:n,payload:i,ref:a}=t;(a&&a===this.pendingHeartbeatRef||n===i?.type)&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(s)).forEach(o=>o._trigger(n,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this._sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(se.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(ya,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([xa],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class ja{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ze.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class qr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function q(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Ia extends qr{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class gr extends qr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Ra=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const vn=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>et(async()=>{const{default:s}=await Promise.resolve().then(()=>it);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Ca=()=>Ra(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield et(()=>Promise.resolve().then(()=>it),void 0)).Response:Response}),mr=r=>{if(Array.isArray(r))return r.map(t=>mr(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=mr(s)}),e};var Ne=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const er=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),La=(r,e,t)=>Ne(void 0,void 0,void 0,function*(){const s=yield Ca();r instanceof s&&!t?.noResolveJson?r.json().then(n=>{e(new Ia(er(n),r.status||500))}).catch(n=>{e(new gr(er(n),n))}):e(new gr(er(r),r))}),Da=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),t))};function St(r,e,t,s,n,i){return Ne(this,void 0,void 0,function*(){return new Promise((a,o)=>{r(t,Da(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>La(l,o,s))})})}function qt(r,e,t,s){return Ne(this,void 0,void 0,function*(){return St(r,"GET",e,t,s)})}function ye(r,e,t,s,n){return Ne(this,void 0,void 0,function*(){return St(r,"POST",e,s,n,t)})}function Ua(r,e,t,s,n){return Ne(this,void 0,void 0,function*(){return St(r,"PUT",e,s,n,t)})}function Na(r,e,t,s){return Ne(this,void 0,void 0,function*(){return St(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function _n(r,e,t,s,n){return Ne(this,void 0,void 0,function*(){return St(r,"DELETE",e,s,n,t)})}var G=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const Ma={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},_s={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class qa{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=vn(n)}uploadOrUpdate(e,t,s,n){return G(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},_s),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n?.headers&&(o=Object.assign(Object.assign({},o),n.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:o},a?.duplex?{duplex:a.duplex}:{})),d=yield h.json();return h.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(q(i))return{data:null,error:i};throw i}})}upload(e,t,s){return G(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return G(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:_s.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(q(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return G(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t?.upsert&&(n["x-upsert"]="true");const i=yield ye(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new qr("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(s){if(q(s))return{data:null,error:s};throw s}})}update(e,t,s){return G(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return G(this,void 0,void 0,function*(){try{return{data:yield ye(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(q(n))return{data:null,error:n};throw n}})}copy(e,t,s){return G(this,void 0,void 0,function*(){try{return{data:{path:(yield ye(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(q(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return G(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield ye(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s?.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s?.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(n){if(q(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return G(this,void 0,void 0,function*(){try{const n=yield ye(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s?.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(n){if(q(n))return{data:null,error:n};throw n}})}download(e,t){return G(this,void 0,void 0,function*(){const n=typeof t?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(t?.transform||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield qt(this.fetch,`${this.url}/${n}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(q(o))return{data:null,error:o};throw o}})}info(e){return G(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield qt(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:mr(s),error:null}}catch(s){if(q(s))return{data:null,error:s};throw s}})}exists(e){return G(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Na(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(q(s)&&s instanceof gr){const n=s.originalError;if([400,404].includes(n?.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const o=typeof t?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(t?.transform||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${c}`)}}}remove(e){return G(this,void 0,void 0,function*(){try{return{data:yield _n(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(q(t))return{data:null,error:t};throw t}})}list(e,t,s){return G(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Ma),t),{prefix:e||""});return{data:yield ye(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(q(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Fa="2.7.1",Ba={"X-Client-Info":`storage-js/${Fa}`};var Ge=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class za{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},Ba),t),this.fetch=vn(s)}listBuckets(){return Ge(this,void 0,void 0,function*(){try{return{data:yield qt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(q(e))return{data:null,error:e};throw e}})}getBucket(e){return Ge(this,void 0,void 0,function*(){try{return{data:yield qt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(q(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ge(this,void 0,void 0,function*(){try{return{data:yield ye(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(q(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Ge(this,void 0,void 0,function*(){try{return{data:yield Ua(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(q(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ge(this,void 0,void 0,function*(){try{return{data:yield ye(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(q(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ge(this,void 0,void 0,function*(){try{return{data:yield _n(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(q(t))return{data:null,error:t};throw t}})}}class Ja extends za{constructor(e,t={},s){super(e,t,s)}from(e){return new qa(this.url,this.headers,e,this.fetch)}}const Ha="2.46.2";let ht="";typeof Deno<"u"?ht="deno":typeof document<"u"?ht="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ht="react-native":ht="node";const Va={"X-Client-Info":`supabase-js-${ht}/${Ha}`},Ga={headers:Va},Ka={schema:"public"},Wa={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Qa={};var Ya=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const Xa=r=>{let e;return r?e=r:typeof fetch>"u"?e=sn:e=fetch,(...t)=>e(...t)},Za=()=>typeof Headers>"u"?nn:Headers,eo=(r,e,t)=>{const s=Xa(t),n=Za();return(i,a)=>Ya(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:r;let c=new n(a?.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},a),{headers:c}))})};var to=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};function ro(r){return r.replace(/\/$/,"")}function so(r,e){const{db:t,auth:s,realtime:n,global:i}=r,{db:a,auth:o,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},c),i),accessToken:()=>to(this,void 0,void 0,function*(){return""})};return r.accessToken?u.accessToken=r.accessToken:delete u.accessToken,u}const pn="2.65.1",no="http://localhost:9999",io="supabase.auth.token",ao={"X-Client-Info":`gotrue-js/${pn}`},ps=10,yr="X-Supabase-Api-Version",gn={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function oo(r){return Math.round(Date.now()/1e3)+r}function lo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const re=()=>typeof document<"u",Ie={tested:!1,writable:!1},vt=()=>{if(!re())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ie.tested)return Ie.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Ie.tested=!0,Ie.writable=!0}catch{Ie.tested=!0,Ie.writable=!1}return Ie.writable};function tr(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const mn=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>et(async()=>{const{default:s}=await Promise.resolve().then(()=>it);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},co=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",yn=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},$t=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Pt=async(r,e)=>{await r.removeItem(e)};function uo(r){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,n,i,a,o,l,c,u=0;for(r=r.replace("-","+").replace("_","/");u<r.length;)a=e.indexOf(r.charAt(u++)),o=e.indexOf(r.charAt(u++)),l=e.indexOf(r.charAt(u++)),c=e.indexOf(r.charAt(u++)),s=a<<2|o>>4,n=(o&15)<<4|l>>2,i=(l&3)<<6|c,t=t+String.fromCharCode(s),l!=64&&n!=0&&(t=t+String.fromCharCode(n)),c!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class Vt{constructor(){this.promise=new Vt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Vt.promiseConstructor=Promise;function gs(r){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=r.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(uo(s))}async function ho(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function fo(r,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await r(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){n(a);return}}})()})}function vo(r){return("0"+r.toString(16)).substr(-2)}function _o(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let i=0;i<56;i++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,vo).join("")}async function po(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}function go(r){return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function mo(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await po(r);return go(t)}async function Ke(r,e,t=!1){const s=_o();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await yn(r,`${e}-code-verifier`,n);const i=await mo(s);return[i,s===i?"plain":"s256"]}const yo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function wo(r){const e=r.headers.get(yr);if(!e||!e.match(yo))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class Fr extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function $(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class bo extends Fr{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function ko(r){return $(r)&&r.name==="AuthApiError"}class wn extends Fr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Me extends Fr{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class pe extends Me{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Eo(r){return $(r)&&r.name==="AuthSessionMissingError"}class rr extends Me{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class xt extends Me{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class At extends Me{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ms extends Me{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class wr extends Me{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function sr(r){return $(r)&&r.name==="AuthRetryableFetchError"}class ys extends Me{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}var So=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const Re=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),To=[502,503,504];async function ws(r){var e;if(!co(r))throw new wr(Re(r),0);if(To.includes(r.status))throw new wr(Re(r),r.status);let t;try{t=await r.json()}catch(i){throw new wn(Re(i),i)}let s;const n=wo(r);if(n&&n.getTime()>=gn["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new ys(Re(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new pe}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new ys(Re(t),r.status,t.weak_password.reasons);throw new bo(Re(t),r.status||500,s)}const Oo=(r,e,t,s)=>{const n={method:r,headers:e?.headers||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function x(r,e,t,s){var n;const i=Object.assign({},s?.headers);i[yr]||(i[yr]=gn["2024-01-01"].name),s?.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(n=s?.query)!==null&&n!==void 0?n:{};s?.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await $o(r,e,t+o,{headers:i,noResolveJson:s?.noResolveJson},{},s?.body);return s?.xform?s?.xform(l):{data:Object.assign({},l),error:null}}async function $o(r,e,t,s,n,i){const a=Oo(e,s,n,i);let o;try{o=await r(t,Object.assign({},a))}catch(l){throw console.error(l),new wr(Re(l),0)}if(o.ok||await ws(o),s?.noResolveJson)return o;try{return await o.json()}catch(l){await ws(l)}}function ge(r){var e;let t=null;jo(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=oo(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function bs(r){const e=ge(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function we(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function Po(r){return{data:r,error:null}}function xo(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i}=r,a=So(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Ao(r){return r}function jo(r){return r.access_token&&r.refresh_token&&r.expires_in}var Io=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class Ro{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=mn(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await x(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if($(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await x(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:we})}catch(s){if($(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Io(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s?.newEmail,delete n.newEmail),await x(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:xo,redirectTo:t?.redirectTo})}catch(t){if($(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await x(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:we})}catch(t){if($(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await x(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Ao});if(u.error)throw u.error;const h=await u.json(),d=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(_=>{const p=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(_.split(";")[1].split("=")[1]);c[`${m}Page`]=p}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if($(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await x(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:we})}catch(t){if($(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await x(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:we})}catch(s){if($(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await x(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:we})}catch(s){if($(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await x(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if($(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await x(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if($(t))return{data:null,error:t};throw t}}}const Co={getItem:r=>vt()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{vt()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{vt()&&globalThis.localStorage.removeItem(r)}};function ks(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Lo(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const We={debug:!!(globalThis&&vt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class bn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Do extends bn{}async function Uo(r,e,t){We.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),We.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){We.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{We.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw We.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Do(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(We.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}})}Lo();const No={url:no,storageKey:io,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ao,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},lt=30*1e3,Es=3;async function Ss(r,e,t){return await t()}class gt{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=gt.nextInstanceID,gt.nextInstanceID+=1,this.instanceID>0&&re()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},No),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Ro({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=mn(n.fetch),this.lock=n.lock||Ss,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:re()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=Uo:this.lock=Ss,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:vt()?this.storage=Co:(this.memoryStorage={},this.storage=ks(this.memoryStorage)):(this.memoryStorage={},this.storage=ks(this.memoryStorage)),re()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${pn}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=re()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:s}=await this._getSessionFromURL(e);if(s)return this._debug("#_initialize()","error detecting session from URL",s),s?.code==="identity_already_exists"?{error:s}:(await this._removeSession(),{error:s});const{session:n,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",n,"redirect type",i),await this._saveSession(n),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",n):await this._notifyAllSubscribers("SIGNED_IN",n)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return $(e)?{error:e}:{error:new wn("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const i=await x(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:ge}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if($(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,n;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,_=null;this.flowType==="pkce"&&([f,_]=await Ke(this.storage,this.storageKey)),i=await x(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:u,password:h,data:(t=d?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:_},xform:ge})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await x(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=d?.data)!==null&&s!==void 0?s:{},channel:(n=d?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:ge})}else throw new xt("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if($(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await x(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:bs})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await x(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:bs})}else throw new xt("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new rr}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if($(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await $t(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:i,error:a}=await x(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ge});if(await Pt(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new rr}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:a})}catch(i){if($(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:i,nonce:a}=e,o=await x(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:ge}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new rr}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if($(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,i,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ke(this.storage,this.storageKey));const{error:h}=await x(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l?.data)!==null&&t!==void 0?t:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await x(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l?.data)!==null&&n!==void 0?n:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(a=l?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new xt("You must provide either an email or phone number.")}catch(o){if($(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let n,i;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await x(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:ge});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if($(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await Ke(this.storage,this.storageKey)),await x(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:Po})}catch(i){if($(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new pe;const{error:n}=await x(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if($(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:a}=await x(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:a,error:o}=await x(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:o}}throw new xt("You must provide either an email or phone number and a type")}catch(t){if($(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await $t(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await x(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:we}):await this._useSession(async t=>{var s,n,i;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new pe}:await x(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:we})})}catch(t){if($(t))return Eo(t)&&(await this._removeSession(),await Pt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new pe;const a=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await Ke(this.storage,this.storageKey));const{data:c,error:u}=await x(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:we});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if($(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return gs(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new pe;const t=Date.now()/1e3;let s=t,n=!0,i=null;const a=gs(e.access_token);if(a.exp&&(s=a.exp,n=s<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if($(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!e?.refresh_token)throw new pe;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if($(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e){try{if(!re())throw new At("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new At("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new ms("Not a valid PKCE flow url.");const t=tr(window.location.href);if(e){if(!t.code)throw new ms("No code detected.");const{data:E,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const g=new URL(window.location.href);return g.searchParams.delete("code"),window.history.replaceState(window.history.state,"",g.toString()),{data:{session:E.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new At(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!a||!c)throw new At("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=lt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const _=d-h;u-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,d,u):u-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,d,u);const{data:p,error:m}=await this._getUser(i);if(m)throw m;const b={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:d,refresh_token:a,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:t.type},error:null}}catch(t){if($(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){const e=tr(window.location.href);return!!(re()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=tr(window.location.href),t=await $t(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return{error:i};const a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(ko(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Pt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=lo(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:i},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Ke(this.storage,this.storageKey,!0));try{return await x(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if($(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if($(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async i=>{var a,o,l,c,u;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await x(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return re()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s?.url),{data:{provider:e.provider,url:s?.url},error:null}}catch(s){if($(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)throw a;return await x(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if($(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await fo(async n=>(n>0&&await ho(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await x(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ge})),(n,i)=>{const a=200*Math.pow(2,n);return i&&sr(i)&&Date.now()+a-s<lt})}catch(s){if(this._debug(t,"error",s),$(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),re()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await $t(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const n=Math.round(Date.now()/1e3),i=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<n+ps;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${ps}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),sr(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new pe;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Vt;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new pe;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(n,"error",i),$(i)){const a={session:null,error:i};return sr(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await yn(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Pt(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&re()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),lt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/lt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${lt}ms, refresh threshold is ${Es} ticks`),n<=Es&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof bn)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!re()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s?.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await Ke(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(o.toString())}if(s?.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s?.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await x(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if($(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await x(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=i?.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l?.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if($(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await x(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if($(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await x(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n?.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if($(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=e?.factors||[],n=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}gt.nextInstanceID=0;const Mo=gt;class qo extends Mo{constructor(e){super(e)}}var Fo=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class Bo{constructor(e,t,s){var n,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=ro(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:Ka,realtime:Qa,auth:Object.assign(Object.assign({},Wa),{storageKey:l}),global:Ga},u=so(s??{},c);this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=eo(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},u.realtime)),this.rest=new _a(`${o}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new ta(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ja(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Fo(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:i,flowType:a,lock:o,debug:l},c,u){var h;const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new qo({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:a,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:(h="Authorization"in this.headers)!==null&&h!==void 0?h:!1})}_initRealtimeClient(e){return new Aa(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s?.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.realtime.setAuth(s??null),this.changedAccessToken=s):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const zo=(r,e,t)=>new Bo(r,e,t),Ts="[a-fA-F\\d:]",be=r=>r&&r.includeBoundaries?`(?:(?<=\\s|^)(?=${Ts})|(?<=${Ts})(?=\\s|$))`:"",ne="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",U="[a-fA-F\\d]{1,4}",Gt=`
(?:
(?:${U}:){7}(?:${U}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${U}:){6}(?:${ne}|:${U}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${U}:){5}(?::${ne}|(?::${U}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${U}:){4}(?:(?::${U}){0,1}:${ne}|(?::${U}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${U}:){3}(?:(?::${U}){0,2}:${ne}|(?::${U}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${U}:){2}(?:(?::${U}){0,3}:${ne}|(?::${U}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${U}:){1}(?:(?::${U}){0,4}:${ne}|(?::${U}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${U}){0,5}:${ne}|(?::${U}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),Jo=new RegExp(`(?:^${ne}$)|(?:^${Gt}$)`),Ho=new RegExp(`^${ne}$`),Vo=new RegExp(`^${Gt}$`),Kt=r=>r&&r.exact?Jo:new RegExp(`(?:${be(r)}${ne}${be(r)})|(?:${be(r)}${Gt}${be(r)})`,"g");Kt.v4=r=>r&&r.exact?Ho:new RegExp(`${be(r)}${ne}${be(r)}`,"g");Kt.v6=r=>r&&r.exact?Vo:new RegExp(`${be(r)}${Gt}${be(r)}`,"g");function Go(r){const e=(...t)=>r(...t);return Object.defineProperty(e,"name",{value:`functionTimeout(${r.name||"<anonymous>"})`,configurable:!0}),e}const{toString:Ko}=Object.prototype;function Wo(r){return Ko.call(r)==="[object RegExp]"}const Os={global:"g",ignoreCase:"i",multiline:"m",dotAll:"s",sticky:"y",unicode:"u"};function Qo(r,e={}){if(!Wo(r))throw new TypeError("Expected a RegExp instance");const t=Object.keys(Os).map(n=>(typeof e[n]=="boolean"?e[n]:r[n])?Os[n]:"").join(""),s=new RegExp(e.source||r.source,t);return s.lastIndex=typeof e.lastIndex=="number"?e.lastIndex:r.lastIndex,s}function kn(r,e,{timeout:t}={}){try{return Go(()=>Qo(r).test(e),{timeout:t})()}catch(s){throw s}}const Yo=15,Xo=45,En={timeout:400};function Zo(r){return r.length>Xo?!1:kn(Kt.v6({exact:!0}),r,En)}function el(r){return r.length>Yo?!1:kn(Kt.v4({exact:!0}),r,En)}class tl extends Error{constructor(e){super("Could not get the public IP address",e),this.name="IpNotFoundError"}}class Sn extends Error{constructor(){super("Request was cancelled"),this.name="CancelError"}get isCanceled(){return!0}}const Tn={timeout:5e3},rl={v4:["https://ipv4.icanhazip.com/","https://api.ipify.org/"],v6:["https://ipv6.icanhazip.com/","https://api6.ipify.org/"]},sl=(r,e,t)=>{const s=new XMLHttpRequest;let n;const i=new Promise((a,o)=>{n=o,s.addEventListener("error",o,{once:!0}),s.addEventListener("timeout",o,{once:!0}),s.addEventListener("load",()=>{const l=s.responseText.trim();if(!l||!(t==="v6"?Zo:el)(l)){o();return}a(l)},{once:!0}),s.open("GET",r),s.timeout=e.timeout,s.send()});return i.cancel=()=>{s.abort(),n(new Sn)},i},On=(r,e)=>{let t;const s=async function(){const n=[...rl[r],...e.fallbackUrls??[]];let i;for(const a of n)try{return t=sl(a,e,r),await t}catch(o){if(i=o,o instanceof Sn)throw o}throw new tl({cause:i})}();return s.cancel=()=>{t.cancel()},s};function nl(r){return On("v4",{...Tn,...r})}function il(r){return On("v6",{...Tn,...r})}async function al(r){if(r={timeout:5e3,ipVersion:4,...r},!navigator?.onLine)return!1;const e=r.ipVersion===4?nl:il;try{return await e(r),!0}catch{return!1}}const V=await al(),H=V?zo("https://gpprfxmjjjowyuqgvwzr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdwcHJmeG1qampvd3l1cWd2d3pyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzA4NDU0NTQsImV4cCI6MjA0NjQyMTQ1NH0.e_RwbQVTsd4ggnH79bcX8gWL8o61pZ_wan5ypQjB77Q"):null,ue=V?await ol():null;async function ol(){if(!V)return null;const{data:r,error:e}=await H.auth.getUser();return e?null:r.user.id}async function ll(){if(!V)return null;const{error:r}=await H.auth.signOut();r?alert("Error signing out: "+r.message):window.location.reload()}async function cl(r,e){if(!V)return null;const{data:t,error:s}=await H.auth.signInWithPassword({email:r,password:e});s?alert("Error signing in: "+s.message):window.location.reload()}async function ul(r,e){if(!V)return null;const{data:t,error:s}=await H.auth.signUp({email:r,password:e});s?alert("Error signing up: "+s.message):window.location.reload()}async function hl(){if(V){const{data:r}=await H.from("exams").select("course_exam, start_time, classrooms").order("start_time",{ascending:!0});if(r)return localStorage.setItem("exams",JSON.stringify(r)),r}return JSON.parse(localStorage.getItem("exams"))}async function dl(){if(!V)return null;const{data:r}=await H.from("course_codes").select("courses");if(r&&r.length>0){const e=r[0].courses;if(localStorage.setItem("course_codes",e),e!="")return r[0].courses}return""}async function $s(r){if(!V)return null;const e=Array.from(r).join(",");if(ue){const{error:t}=await H.from("course_codes").upsert({userid:ue,courses:e});t&&console.error(t)}}async function fl(){if(!V)return null;const{data:r}=await H.from("options").select("*");return r&&r.length>0?r[0]:null}async function vl(r){if(!V)return null;if(ue){const{error:e}=await H.from("options").upsert({userid:ue,time:r.time,rows:r.rows});e&&console.error(e)}}async function _l(){if(!V)return null;const{data:r}=await H.from("course").select("*");return r&&r.length>0?r.map(t=>({name:t.name,section:t.section,room:t.room,color:String(t.color),row:t.row,col:t.col})):null}async function pl(){if(V){const{data:r}=await H.from("exams_update_date").select("last_updated").eq("id",1).single();return new Date(r.last_updated).getTime()}return 1741703246690}async function gl(r){if(V){const e=r.slice(0,20).includes("Date"),t=await H.from("exams").delete().eq("is_final",e);if(t.error){console.error("Error deleting old exams:",t.error.message);return}const s=ml(r,e),n=await H.from("exams").insert(s);if(n.error){console.error("Failed to insert exams:",n.error.message);return}const{error:i}=await H.from("exams_update_date").upsert({id:1,last_updated:new Date});i&&console.log(i)}}function ml(r,e){const t=r.split(`
`).slice(1),s=[];if(e)for(const n of t){const i=n.split("	");s.push({course_exam:i[0],start_time:i[1].split(" ")[0]+"T"+i[2].slice(0,5)+":00",classrooms:i[3],is_final:!0})}else for(const n of t){const i=n.split("	");let a=i[1].split(" ");s.push({course_exam:i[0],start_time:a[0]+"T"+a[2]+":00",classrooms:i[3],is_final:!1})}return console.log(s),s}let yl=class{#e=j(P(JSON.parse(localStorage.getItem("schedule"))!=""?JSON.parse(localStorage.getItem("schedule"))||[]:[]));get schedule(){return v(this.#e)}set schedule(e){w(this.#e,P(e))}constructor(){_l().then(e=>{e&&(ie.schedule=e)})}};const ie=new yl;class wl{#e=j("");get cellModalId(){return v(this.#e)}set cellModalId(e){w(this.#e,P(e))}#t=j(!1);get signInModal(){return v(this.#t)}set signInModal(e){w(this.#t,P(e))}#r=j(!1);get signUpModal(){return v(this.#r)}set signUpModal(e){w(this.#r,P(e))}}const X=new wl;class bl{#e=j(P(new Te([])));get tags(){return v(this.#e)}set tags(e){w(this.#e,P(e))}constructor(){const e=localStorage.getItem("tags");e&&(this.tags=new Te(e.split(","))),F(()=>{localStorage.setItem("tags",Array.from(this.tags).join(","))})}addTags(e){let t=!1;return Array.from(e.matchAll(/([A-Z]{3,4})\s?(\d{3,4})/g)).forEach(s=>{this.tags.add(s[1]+" "+s[2]),t=!0}),$s(this.tags),t}removeTag(e){this.tags.delete(e),console.log("removed tag "+this.tags),$s(this.tags)}}let ct;function $n(){return ct||(ct=new bl,dl().then(r=>{ct.addTags(r)}),ct)}var kl=N("<option></option>"),El=N("<option></option>"),Sl=N("<option></option>"),Tl=N('<datalist id="courseCodes"></datalist> <datalist id="sections"></datalist> <datalist id="classrooms"></datalist>',1);function Ol(r,e){Z(e,!0);let t=P(new Te),s=P(new Te),n=P(new Te);F(()=>{t.clear(),s.clear(),n.clear(),ie.schedule.forEach(c=>{t.add(c.name),s.add(c.section),n.add(c.room)})});var i=Tl(),a=xr(i);Se(a,21,()=>t,Ee,(c,u)=>{var h=kl(),d={};ae(()=>{d!==(d=v(u))&&(h.value=(h.__value=v(u))==null?"":v(u))}),L(c,h)});var o=k(a,2);Se(o,21,()=>s,Ee,(c,u)=>{var h=El(),d={};ae(()=>{d!==(d=v(u))&&(h.value=(h.__value=v(u))==null?"":v(u))}),L(c,h)});var l=k(o,2);Se(l,21,()=>n,Ee,(c,u)=>{var h=Sl(),d={};ae(()=>{d!==(d=v(u))&&(h.value=(h.__value=v(u))==null?"":v(u))}),L(c,h)}),L(r,i),ee()}var $l=N('<div class="svelte-5k2taf"></div>');function Pl(r){var e=$l();Mt(e,"style",`display: ${(V?"none":"block")??""};`),L(r,e)}var xl=(r,e)=>{r.target===v(e)&&v(e).close()},Al=N('<dialog><div class="modal svelte-1mcqfih"><form class="svelte-1mcqfih"><h2 class="svelte-1mcqfih">Sign In</h2> <input type="email" placeholder="Email" class="svelte-1mcqfih"> <input type="password" placeholder="Password" class="svelte-1mcqfih"> <button type="submit">Sign In</button> <p class="svelte-1mcqfih">New to the app? <span role="button" tabindex="0" class="svelte-1mcqfih">Sign up</span></p></form></div></dialog>');function jl(r,e){Z(e,!0);let t=j(void 0),s=j(""),n=j("");F(()=>{if(!X.signInModal){v(t).close();return}v(t).showModal(),w(s,""),w(n,"")});var i=Al();i.__click=[xl,t];var a=O(i),o=O(a),l=k(O(o),2),c=k(l,2),u=k(c,4),h=k(O(u));h.__click=()=>{v(t).close(),X.signUpModal=!0},Et(i,d=>w(t,d),()=>v(t)),Pe("close",i,()=>X.signInModal=!1),Pe("submit",o,d=>{d.preventDefault(),cl(v(s),v(n))}),te(l,()=>v(s),d=>w(s,d)),te(c,()=>v(n),d=>w(n,d)),L(r,i),ee()}_e(["click"]);var Il=(r,e)=>{r.target===v(e)&&v(e).close()},Rl=N('<dialog><div class="modal svelte-1mcqfih"><form class="svelte-1mcqfih"><h2 class="svelte-1mcqfih">Sign Up</h2> <input type="email" placeholder="Email" class="svelte-1mcqfih"> <input type="password" placeholder="Password" class="svelte-1mcqfih"> <input type="password" placeholder="Confirm Password" class="svelte-1mcqfih"> <button>Sign Up</button> <p class="svelte-1mcqfih">Already have an account? <span role="button" tabindex="0" class="svelte-1mcqfih">Sign in</span></p></form></div></dialog>');function Cl(r,e){Z(e,!0);let t=j(void 0),s=j(""),n=j(""),i=j("");F(()=>{if(!X.signUpModal){v(t).close();return}v(t).showModal(),w(s,""),w(n,"")});function a(p,m,b){if(m.length<8){alert("Password must be at least 8 characters long");return}if(m!==b){alert("Passwords do not match");return}ul(p,m)}var o=Rl();o.__click=[Il,t];var l=O(o),c=O(l),u=k(O(c),2),h=k(u,2),d=k(h,2),f=k(d,4),_=k(O(f));_.__click=()=>{v(t).close(),X.signInModal=!0},Et(o,p=>w(t,p),()=>v(t)),Pe("close",o,()=>X.signUpModal=!1),Pe("submit",c,p=>{p.preventDefault(),a(v(s),v(n),v(i))}),te(u,()=>v(s),p=>w(s,p)),te(h,()=>v(n),p=>w(n,p)),te(d,()=>v(i),p=>w(i,p)),L(r,o),ee()}_e(["click"]);var Ll=(r,e)=>{w(e,!v(e))},Dl=N('<div class="svelte-1kg81n5"><!> <!> <!> <h2 class="svelte-1kg81n5">METU Scheduler and CEF</h2>  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" class="svelte-1kg81n5"><path d="M192 64C86 64 0 150 0 256S86 448 192 448l192 0c106 0 192-86 192-192s-86-192-192-192L192 64zm192 96a96 96 0 1 1 0 192 96 96 0 1 1 0-192z"></path></svg> <button> </button></div>');function Ul(r,e){Z(e,!0);let t=j(P(JSON.parse(localStorage.getItem("theme"))||!1));F(()=>{v(t)?document.documentElement.className="dark":document.documentElement.className="light",localStorage.setItem("theme",JSON.stringify(v(t)))});const s=V?ue?"Sign_Out":"Sign_In":"Offline";var n=Dl(),i=O(n);Pl(i);var a=k(i,2);jl(a,{});var o=k(a,2);Cl(o,{});var l=k(o,4);l.__click=[Ll,t];var c=k(l,2);rn(c,`${s??""} svelte-1kg81n5`),c.__click=function(...h){(ue?ll:()=>{X.signInModal=!0})?.apply(this,h)};var u=O(c);ae(()=>ce(u,s.replace("_"," "))),L(r,n),ee()}_e(["click"]);var Nl=(r,e,t)=>{e.removeTag(v(t))},Ml=N('<span class="svelte-1e4xmey"> </span>'),ql=(r,e,t)=>{if(r.key==="Backspace"&&v(e)==""){let s=Array.from(t.tags).slice(-1);t.removeTag(s)}},Fl=N('<div class="svelte-1e4xmey"><label for="tagsInput" class="svelte-1e4xmey">Write course codes then press enter</label> <form class="svelte-1e4xmey"><!> <input type="text" id="tagsInput" list="courseCodes" class="svelte-1e4xmey"></form></div>');function Bl(r,e){Z(e,!0);const t=$n();let s=j(""),n=0;F(()=>{w(s,P(v(s).toUpperCase())),v(s).length-n>2&&(n=0,t.addTags(v(s))&&w(s,"")),n=v(s).length});var i=Fl(),a=k(O(i),2),o=O(a);Se(o,17,()=>t.tags,Ee,(c,u)=>{var h=Ml();h.__click=[Nl,t,u];var d=O(h);ae(()=>ce(d,v(u))),L(c,h)});var l=k(o,2);l.__keydown=[ql,s,t],Pe("submit",a,c=>{c.preventDefault(),t.addTags(v(s))&&w(s,"")}),te(l,()=>v(s),c=>w(s,c)),L(r,i),ee()}_e(["click","keydown"]);var zl=N('<tr><td class="svelte-gvwsmc"> </td><td class="svelte-gvwsmc"> </td><td class="svelte-gvwsmc"> </td><td class="svelte-gvwsmc"> </td><td class="svelte-gvwsmc"> </td></tr>'),Jl=N('<!> <div class="svelte-gvwsmc"><table><thead><tr><th>Course Exam</th><th>Days Until</th><th>Days Between</th><th>Start Time</th><th>Classrooms</th></tr></thead><tbody></tbody></table></div> <span class="svelte-gvwsmc"> </span>',1);function Hl(r,e){Z(e,!0);const t=$n();let s=[],n=j(P(s)),i=j("");F(()=>{const _=Array.from(t.tags),p=s.filter(m=>_.includes(m.course_exam.match(/([A-Z]{3,4})\s?(\d{3,4})/g)[0]));w(n,P(a(p)))}),hl().then(_=>{if(!_)return;s=_;const p=Array.from(t.tags),m=s.filter(b=>p.includes(b.course_exam.match(/([A-Z]{3,4})\s?(\d{3,4})/g)[0]));w(n,P(a(m)))}),pl().then(_=>{const p=Date.now(),m=_,b=p-p%864e5;if(p-m>1728e5){let E=m-m%864e5;w(i,"Updated "+Math.floor((b-E)/864e5)+" days ago.")}else w(i,"Updated "+Math.floor((p-m)/36e5)+" hours ago.")});function a(_){const p=Date.now()-new Date().getTimezoneOffset()*6e4,m=p-p%864e5;let b=[],E=p;return _.forEach(T=>{const g=new Date(T.start_time),y=g.getFullYear(),S=String(g.getMonth()+1).padStart(2,"0"),D=String(g.getDate()).padStart(2,"0"),B=g.toLocaleString("en-US",{weekday:"short"}),qe=String(g.getHours()).padStart(2,"0"),xe=String(g.getMinutes()).padStart(2,"0"),Ae=`${y}-${S}-${D} ${B} ${qe}:${xe}`,je=g.getTime()-g.getTime()%864e5;b.push({course_exam:T.course_exam,days_until:Math.max(Math.floor(je/864e5)-Math.floor(m/864e5),0),days_between:Math.max(Math.floor(je/864e5)-Math.floor(E/864e5),0),start_time:Ae,classrooms:T.classrooms}),E=je}),b}var o=Jl(),l=xr(o);Bl(l,{});var c=k(l,2),u=O(c),h=k(O(u));Se(h,21,()=>v(n),Ee,(_,p)=>{var m=zl(),b=O(m),E=O(b),T=k(b),g=O(T),y=k(T),S=O(y),D=k(y),B=O(D),qe=k(D),xe=O(qe);ae(()=>{ce(E,v(p).course_exam),ce(g,v(p).days_until),ce(S,v(p).days_between),ce(B,v(p).start_time),ce(xe,v(p).classrooms)}),L(_,m)});var d=k(c,2),f=O(d);ae(()=>ce(f,`Notice: The exam data may be out of date as CET system is updated fairly randomly. ${v(i)??""}`)),L(r,o),ee()}var Vl=(r,e)=>{r.target===v(e)&&v(e).close()},Gl=(r,e,t,s)=>{e("08:40"),t(12),v(s).close()},Kl=N('<dialog><div class="modal svelte-1llevdu"><h2 class="svelte-1llevdu">Options</h2> <form class="rows svelte-1llevdu"><label for="startTime" class="svelte-1llevdu"><span>Start Time</span> <input type="time" name="startTime" id="startTime"></label> <label for="rowNum" class="svelte-1llevdu"><span>Number of Rows</span> <input style="width: 5rem" type="number" name="rowNum" id="rowNum" min="2" max="16"></label></form> <input class="reset svelte-1llevdu" type="button" value="Restore defaults"></div></dialog>');function Wl(r,e){Z(e,!0);let t=Yt(e,"showOptionsModal",15,!1),s=Yt(e,"startTime",15,"08:40"),n=Yt(e,"rowNum",15,12);fl().then(_=>{_&&(s(_.time),n(_.rows))});let i=j(void 0);F(()=>{if(!t()){v(i).close();return}v(i).showModal()});var a=Kl();a.__click=[Vl,i];var o=O(a),l=k(O(o),2),c=O(l),u=k(O(c),2),h=k(c,2),d=k(O(h),2),f=k(l,2);f.__click=[Gl,s,n,i],Et(a,_=>w(i,_),()=>v(i)),Pe("close",a,()=>{t(!1),vl({time:s(),rows:n()})}),Pe("submit",l,_=>{_.preventDefault(),v(i).close()}),te(u,s),te(d,n),L(r,a),ee()}_e(["click"]);var Ql=(r,e)=>{r.target===v(e)&&v(e).close()},Yl=(r,e,t)=>w(e,P(t)),Xl=N("<button></button>"),Zl=(r,e)=>v(e).close(),ec=N('<dialog><div class="modal svelte-kvggo"><div class="inside svelte-kvggo"><input type="text" list="courseCodes" placeholder="Name" class="svelte-kvggo"> <input type="text" list="sections" placeholder="Section" class="svelte-kvggo"> <input type="text" list="classrooms" placeholder="Room" class="svelte-kvggo"></div> <div class="color svelte-kvggo"></div> <div class="buttons svelte-kvggo"><button style="margin-right: auto; color: var(--red)" class="svelte-kvggo">Delete</button> <button style="margin-right: 0.4rem" class="svelte-kvggo">Save</button> <button style="color: var(--acccent)" class="svelte-kvggo">Cancel</button></div></div></dialog>');function tc(r,e){Z(e,!0);let t=j("t"),s=j(""),n=j(""),i=j(""),a=j(void 0);F(()=>{if(X.cellModalId==""){v(a).close();return}v(a).showModal();const g=X.cellModalId.slice(1,3);w(s,""),w(i,""),w(t,"0"),w(n,""),ie.schedule.forEach(y=>{y.row.toString(16)==g[0]&&y.col.toString(16)==g[1]&&(w(s,P(y.name)),w(n,P(y.section)),w(i,P(y.room)),w(t,P(y.color)))}),console.log("color")}),F(()=>{w(s,P(v(s).toUpperCase())),w(n,P(v(n).toUpperCase())),w(i,P(v(i).toUpperCase()))}),F(()=>{const g=document.getElementsByClassName("colorBtn");for(let y=0;y<g.length;y++)g[y].classList.remove("selected"),g[y].style.backgroundColor=="var(--{color})"&&g[y].classList.add("selected")}),F(()=>{localStorage.setItem("schedule",JSON.stringify(ie.schedule))});async function o(){console.log(v(t));const g=X.cellModalId.slice(1,3);if(ue){const{error:S}=await H.from("course").upsert({userid:ue,name:v(s),section:v(n),room:v(i),color:v(t),row:parseInt(g[0],16),col:parseInt(g[1],16)});S&&console.log(S)}let y=!1;ie.schedule.forEach(S=>{S.col==parseInt(g[1],16)&&S.row==parseInt(g[0],16)&&(S.name=v(s),S.section=v(n),S.room=v(i),S.color=v(t),y=!0)}),y||ie.schedule.push({name:v(s),section:v(n),room:v(i),color:v(t),row:parseInt(g[0],16),col:parseInt(g[1],16)}),v(a).close()}async function l(){const g=X.cellModalId.slice(1,3);if(ue){const{error:y}=await H.from("course").delete().eq("userid",ue).eq("row",parseInt(g[0],16)).eq("col",parseInt(g[1],16));y&&console.log(y)}ie.schedule=ie.schedule.filter(y=>y.col!=parseInt(g[1],16)||y.row!=parseInt(g[0],16)),v(a).close()}var c=ec();c.__click=[Ql,a];var u=O(c),h=O(u),d=O(h),f=k(d,2),_=k(f,2),p=k(h,2);Se(p,20,()=>["0","1","2","3","4","5","6","7","8","9"],Ee,(g,y)=>{var S=Xl();S.__click=[Yl,t,y],ae(()=>{Mt(S,"aria-label",`Color ${y??""}`),rn(S,`colorBtn ${(v(t)==y?"selected":"")??""} svelte-kvggo`),Mt(S,"style",`background: var(--${(y||"t")??""}); 
                        outline: calc(var(--cellOutline) * 2) solid var(--o${(y||"t")??""});`)}),L(g,S)});var m=k(p,2),b=O(m);b.__click=l;var E=k(b,2);E.__click=o;var T=k(E,2);T.__click=[Zl,a],Et(c,g=>w(a,g),()=>v(a)),Pe("close",c,()=>X.cellModalId=""),te(d,()=>v(s),g=>w(s,g)),te(f,()=>v(n),g=>w(n,g)),te(_,()=>v(i),g=>w(i,g)),L(r,c),ee()}_e(["click"]);var rc=N('<td draggable="true" class="svelte-100wpi8"><!></td>');function sc(r,e){Z(e,!0);let t=e.course;typeof e.course!="string"&&(t="c"+e.course.row.toString(16)+e.course.col.toString(16));var s=rc();s.__click=()=>X.cellModalId=t;var n=O(s);{var i=a=>{var o=Ai();ae(()=>ce(o,`${e.course.name??""} (${e.course.section??""}) [${e.course.room??""}]`)),L(a,o)};tn(n,a=>{typeof e.course!="string"&&a(i)})}ae(()=>Mt(s,"style",`color: var(--o${(e.course.color||"t")??""});
        outline: var(--cellOutline) solid var(--o${(e.course.color||"t")??""});
        background-color: var(--${(e.course.color||"t")??""})`)),L(r,s),ee()}_e(["click"]);var nc=(r,e)=>w(e,!0),ic=N('<tr><td class="svelte-m4ohi"> </td><!></tr>'),ac=N('<!> <!> <div class="header svelte-m4ohi"><div></div> <h2 class="svelte-m4ohi">Schedule</h2> <div class="btn svelte-m4ohi"><input type="button" value="Options" class="svelte-m4ohi"></div></div> <table class="svelte-m4ohi"><thead><tr><th class="svelte-m4ohi">Time</th><th class="svelte-m4ohi">Monday</th><th class="svelte-m4ohi">Tuesday</th><th class="svelte-m4ohi">Wednesday</th><th class="svelte-m4ohi">Thursday</th><th class="svelte-m4ohi">Friday</th></tr></thead><tbody></tbody></table>',1);function oc(r,e){Z(e,!0);let t=j(!1),s=j(P(localStorage.getItem("startTime")||"08:40")),n=j(P(parseInt(localStorage.getItem("rowNum"))||12)),i=j(P(a(ie.schedule)));F(()=>{localStorage.setItem("startTime",v(s)),localStorage.setItem("rowNum",v(n).toString()),w(i,P(a(ie.schedule)))});function a(p){let m=[];for(let b=0;b<v(n);b++){let[E,T]=v(s).split(":"),g=[`${((b+parseInt(E))%24).toString().padStart(2,"0")}:${T}`];for(let y=0;y<5;y++){let S=!1;p.length>0&&p.forEach(D=>{D.row==b&&D.col==y&&(g.push(D),S=!0)}),S||g.push("c"+b.toString(16)+y.toString(16))}m.push(g)}return m}F(()=>{w(i,P(a(ie.schedule)))});var o=ac(),l=xr(o);tc(l,{});var c=k(l,2);Wl(c,{get showOptionsModal(){return v(t)},set showOptionsModal(p){w(t,P(p))},get startTime(){return v(s)},set startTime(p){w(s,P(p))},get rowNum(){return v(n)},set rowNum(p){w(n,P(p))}});var u=k(c,2),h=k(O(u),4),d=O(h);d.__click=[nc,t];var f=k(u,2),_=k(O(f));Se(_,21,()=>v(i),Ee,(p,m)=>{var b=ic(),E=O(b),T=O(E),g=k(E);Se(g,17,()=>v(m).slice(1),Ee,(y,S)=>{sc(y,{get course(){return v(S)}})}),ae(()=>ce(T,v(m)[0])),L(p,b)}),L(r,o),ee()}_e(["click"]);var lc=(r,e)=>{r.target===v(e)&&v(e).close()},cc=(r,e)=>{gl(v(e)),w(e,"")},uc=N('<dialog><div class="modal svelte-1gjt3m5"><h2 class="svelte-1gjt3m5">Update Exams</h2> <textarea placeholder="Paste exam data" class="svelte-1gjt3m5"></textarea> <button class="svelte-1gjt3m5">Update</button></div></dialog>');function hc(r,e){Z(e,!0);let t=j(void 0),s=j("");zi(async()=>{v(t).showModal()});var n=uc();n.__click=[lc,t];var i=O(n),a=k(O(i),2),o=k(a,2);o.__click=[cc,s],Et(n,l=>w(t,l),()=>v(t)),te(a,()=>v(s),l=>w(s,l)),L(r,n),ee()}_e(["click"]);var dc=N('<main class="svelte-wzh6d4"><!> <!> <!> <!> <!> <a href="https://github.com/UmutSen2662/Scheduler" target="_blank" class="svelte-wzh6d4">Github Page</a></main>');function fc(r,e){Z(e,!1);let t=Qn(!1);new URLSearchParams(window.location.search).get("admin")==="true"&&w(t,!0),Fi();var n=dc(),i=O(n);Ul(i,{});var a=k(i,2);oc(a,{});var o=k(a,2);Hl(o,{});var l=k(o,2);Ol(l,{});var c=k(l,2);{var u=h=>{hc(h,{})};tn(c,h=>{v(t)&&h(u)})}L(r,n),ee()}Ri(fc,{target:document.getElementById("app")});export{ra as g};
